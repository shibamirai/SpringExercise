# Spring練習問題

## Ex.1 Spring プロジェクトの作成

以下の内容でプロジェクトを作成してください。

| 項目 | 内容 |
|:---|:---|
| 名前 | SpringExercise |
| グループ | katachi.spring |
| パッケージ | katachi.spring.exercise |
| プロジェクト依存関係 | Spring Boot Dev Tools <br> Lombok <br> 検証 (Validation) <br> Thymeleaf <br> Spring Web |

### 実装内容

- [http://localhost:8080/](http://localhost:8080/) にアクセスすると index.html を表示するようにしてください
- index.html では h1 タグで "Hello Spring!" と表示してください

## Ex.2 画面遷移

[http://localhost:8080/input](http://localhost:8080/input) で input.html を表示するようにしてください。

### 実装内容

- input.html には名前の入力欄（テキストボックス）と送信ボタンを用意してください
- index.html の h1 タグをリンク（アンカータグ）に変更し、 [http://localhost:8080/](http://localhost:8080/) からこのページに遷移できるようにしてください

## Ex.3 GET パラメータ

[http://localhost:8080/input?name=foo](http://localhost:8080/input?name=foo) のようにしてアクセスしたとき、その URL から name というパラメータを受け取れるようにしてください。

### 実装内容

- パラメータを受け取ったら、その値 (この場合 foo) が名前の入力欄に入力された状態で表示するようにしてください

## Ex.4 POST

input.html の送信ボタンを押すと `/input` に POST リクエストを送信し、profile.html を表示するようにしてください。

### 実装内容

- profile.html では input.html の名前欄に入力された値を表示してください

## Ex.5 フォーム

input.html に以下のフォームコントロールを追加し、名前と同様に各入力値を profile.html で表示するようにしてください。

| 項目 | タイプ | 条件 |
|:---|:---|:---| 
| 誕生日 | `<input type="date">` | 入力値は java.util.Date 型に変換して扱う<br>profile.html では "2025/01/01" というフォーマットで表示する |
| 性別 | ラジオボタン |「男性／女性／その他」のいずれか |
| 血液型 | ドロップダウンリスト |「A 型／B 型／O 型／AB 型」のいずれか |
| 学習内容 | チェックボックス |「Java／PHP／HTML／デザイン／その他」から複数選択<br>選択された項目はすべて表示 |
| 備考 | テキストエリア | 改行も入力されたように表示 |

### 実装内容

- 名前を含むすべての入力項目は Form クラスを作成してデータバインドを行うよう変更してください
- Form の内容は `@Slf4j` を利用してログに出力してください
- ラジオボタン、ドロップダウンリスト、チェックボックスの各選択肢は HTML にハードコーディングせず、Java コード内で定義してください
- Bootstrap を使って見た目を整えてください

## Ex.6 バリデーション

input.html の送信ボタン押下時に、以下の入力値チェック（バリデーション）を行ってください。

| 項目 | バリデーション内容 |
|:---|:---|
| 名前 | 必ず入力されていること（空欄不可） |
| 誕生日 | 必ず入力されていること（空欄不可）<br>正しい日付であること |
| 性別 | 必ず選択されていること |
| 血液型 | 必ず選択されていること |
| 学習内容 | 何か１つは必ず選択されていること |
| 備考 | 必ず入力されていること（空欄不可）<br> 100　文字以内であること |

### 実装内容

- バリデーションエラー時には input.html に戻って入力項目ごとにエラーメッセージを表示してください
- Form の内容は `@Slf4j` を利用してログに出力してください
- その際に表示するエラーメッセージは設定ファイル (*.properties) から取得してください
- 入力欄には入力していた値がそのまま残っているようにしてください

## Ex.7 データベース

MySQLを使って、testdb という名前のデータベースに以下の２つのテーブルを作成してください。

1. `teams` テーブル
    | 列名 | 型（桁） | 制約等 | 備考 |
    |--|--|--|--|
    | id | INT | PRIMARY KEY <br> AUTO_INCREMENT | チーム ID |
    | name | VARCHAR(50) | NOT NULL | チーム名 |

1. `users` テーブル
    | 列名 | 型（桁） | 制約等 | 備考 |
    |--|--|--|--|
    | id | INT | PRIMARY KEY <br> AUTO_INCREMENT | ユーザ ID |
    | team_id | INT | NOT NULL | チーム ID（teams テーブルの外部キー） |
    | name | VARCHAR(50) | NOT NULL | ユーザ名 |

また、それぞれのテーブルに以下のレコードを追加してください。

1. `teams` テーブル
    | id | name |
    |:-:|:-:|
    | 1 | チームA |
    | 2 | チームB |
    | 3 | チームC |
    | 4 | チームD |

1. `users` テーブル
    | id | team_id | name |
    |:-:|:-:|:-:|
    | 1 | 1 | 山田 |
    | 2 | 1 | 鈴木 |
    | 3 | 2 | 中村 |
    | 4 | 2 | 田中 |
    | 5 | 3 | 加藤 |

## Ex.8 Web プロジェクトからのデータベースの利用

[http://localhost:8080/user](http://localhost:8080/user) にアクセスすると、ユーザ一覧画面が表示されるようにしてください。

### 実装内容

- Ex.1 で作成した Web プロジェクトを修正し、**MyBatis** を使って Ex.7 で作成したデータベースを利用できるようにしてください
- ユーザ一覧画面では、データベース `testdb` に登録されている全ユーザのユーザID、名前、所属チーム名を表示してください。

## Ex.9 ユーザ登録

[http://localhost:8080/user/add](http://localhost:8080/user/add) でユーザ登録画面を表示してください。

### 実装内容

- 登録画面では、名前をテキストボックスに入力、チーム名をドロップダウンリストで選択できるようにし、登録ボタン押下で users テーブルにそのユーザを追加してください
- 登録に成功したらユーザ一覧画面にリダイレクトし、登録したユーザも含めて一覧に表示されるようにしてください
- 名前が未入力、またはすでに同じ名前が登録されていた場合は入力エラーとして、ユーザ登録画面でエラーメッセージを表示してください
- 例外が発生した場合は、別途エラー画面を用意してそちらを表示するようにしてください。(`@ControllerAdvice` または `@ExceptionHandler` が利用できます)

## Ex.10 ユーザ削除

動的URL [http://localhost:8080/user/delete/{id}](http://localhost:8080/user/delete/{id}) でユーザを削除できるようにしてください。

### 実装内容
- `{id}` の部分にユーザIDを入れてリクエストすると、該当ユーザを users テーブルから削除してください
- 削除に成功したらユーザ一覧画面にリダイレクトしてください
- ユーザ一覧画面から削除できるように、ユーザごとにリンクボタンを設置してください
